# JSON обертки для новых скриптов

Здесь описаны обертки для работы с json запросами платформы.

Особенности:
* Заворачиваем все json в своё пространство `ISnew.json`.
* Являются наиболее низкоуровневым функционалом.
* Все обертки представляют собой Deferred-объекты из jQuery. Как следствие, мы можем работать с ними в стиле Promises

## Получение информации о товаре

`getProduct( id )`,

где id - id товара.

В ответе приходит json продукта со всей информацией о товаре.

Пример.
````javascript
ISnew.json.getProduct(123456)
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````

## Получение информации о нескольких товарах

`getProductsList( id_list )`,

где id_list - список id товаров, за раз можно получить информацию не более чем о 100 товарах.

В ответе приходит json с отсортированныйм по возрастанию id товаров списком товаров вида
````javascript
{
  products: [
    {/* product info */},
    {/* product info */},
    {/* product info */}
  ]
}
````

**Важно**

Отличие информации о товаре в этом запросе - отстутствие поля "подробное описарние"

Применять в случае, если нужно динамически получить информации о товарах коллекции и подобных.

Пример.
````javascript
ISnew.json.getProductsList([123456, 123457, 123458])
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````

**Важно**

Учтите, что `.done()` сробатывает всегда, даже если запрос будет пустым.

## Отпаравка сообщений

`sendMessage(options)`

options - не понятно. надо полуркать по костылям.

Пример.
````javascript
ISnew.json.sendMessage(options)
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````

**Важно**

Посмотреть, какие тут есть подводные камни - точно не помню!!!

# Работа с корзиной

Далее идут json'ы для работы с корзиной. Они должны полностью включать в себя всю сложность получения информации о составе корзины.

## Получение состава корзины

`getCartItems()`

Нет входных параметров.

Возвращает состав корзины.


Пример.
````javascript
ISnew.json.getCartItems()
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````
**Важно**
* учтите, что если в корзине не больше 4х товаров, она хранится в куках (на уровне обертки это не важно)
* ответ этого запроса **отличен** от ответа других запросов.

## Добавление товара

`addCartItems( id_list )`,

где `id_list` - объект, состоящий из пар id варианта модификации и добавляемого кол-ва.

Ответ - **нужно уточнить**

Пример.
````javascript
ISnew.json.addCartItems({ 123456: 1; 123457: 3; 123450: 100 })
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````

## Удаление товара

`removeCartItem( variant_id )`

`variant_id` - id удаляемой позиции

Ответ - **нужно уточнить**

Пример.
````javascript
ISnew.json.addCartItems( 123456 )
  .done(function(response) {
    console.log(response);
  })
  .fail(function(response) {
    console.log('что-то пошло не так!! ', response);
  });
````

## Обновление состава корзины

**ВНИАМНИЕ** самое трешовое место. нужно понять, как с этим взаимодействовать.

Позволяет
* обновить состав корзины
* удалить несколько позиций
* добавить несколько позиций
* изменить кол-во товаров позиции

`updateCartItems(options)`

options - объект вида

````javascript
{
  variant_id: {
    quantity: кол-во
    method: set | add | remove
  }
}
````

если пустой - то производит просто обновление состава корзины - **нужно уточнить!!!!**

# Работа со сравнением

*Есть глобальное ограничение в 10 товаров в сравнеии*

## Получение списка сравнения

`getCompareItems()`

Ответ - список товаров в сравнении. Вид - нужно уточнить

## Добавление товара в сравнение

`addCompareItem( id )`

Добавляет товар с указанным id в список

Ответ - нужно уточнить, что происходт при добавлении 11ого товара

## Удаление товара из сравнения

`removeCompareItem( id )`

Удаляет товар с указанным id из списка

Отевет - нужно уточнить.